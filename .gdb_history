disassemble main
q
disassemble main
a
q
disassemble main
q
disassemble main
disassemble elfhdr 
q
break main
run
del breakpoints 
break *0x4004a6
run
stepi 
stepi 
stepi 
p/2xw $rbp
p/x $rbp
x/2xw $rbp
x/4xw $rbp
x/10xw $rbp
x/2xw $rbp - 0x8
x/x $rbp - 0x8
q
target remote localhost:1234
break idt
file kernel
break gdt
c
info registers 
x/5i $eip
break idt
c
x/5i $eip
stepi 
x/5i $eip
stepi 
q
target remote localhost:1234
file kernel
break gdt
c
stepi 
ni
ni
ni
stepi 
disassemble set_tss 
break *0x0010049b
c
stepi 
stepi 
disassemble gdt_flush 
disassemble *0x102018
stepi 
stepi 
c
x/10i %eip
x/10i $eip
break idt
c
ni
break tss_flush 
c
q
target remote localhost:1234
file kernel
break gdt
c
break gdt_flush 
c
ni
x/10i $eip
stepi 
break tss_flush 
c
q
target remote localhost:1234
file kernel
break gdt_flush 
c
disassemble gdt_flush 
stepi 
info registers 
bt
bt gdt_flush 
q
file kernel
disassemble gdt_flush 
q
file kernel
break gdt_flush 
c
target remote localhost:1234
c
x/10i $eip
define hook-stop
    info registers
    printf "\n"
    x/16i $pc - 8
    printf "\n"
end
stepi 
stepi 
q
target remote localhost:1234
define hook-stop
    info registers
    printf "\n"
    x/16i $pc - 8
    printf "\n"
end
file kernel
break init_timer 
c
stepi 
x/10i $eip
stepi 
stepi 
reverse-stepi 
stepi 
print (void *)interrupt_descriptors 
print (void *)interrupt_descriptors [32]
stepi 
print (void *)interrupt_descriptors [32]
stepi 
print (void *)interrupt_descriptors [32]
disassemble *0x101288
stepi 
ni
stepi 
ni
stepi 
ni
stepi 
q
